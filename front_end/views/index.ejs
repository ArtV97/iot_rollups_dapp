<!DOCTYPE html>
<html>

<head lang="pt-br">
	<title>Cartesi Rollups Dapp</title>
	<meta charset="utf-8">
	<link href="bootstrap-5.1.3-dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body id="home">
	<div class="container">
        <form>
            <div class="mb-3">
                <label for="selectedAddress" class="form-label">From Address</label>
                <select id="selectedAddress" class="form-select">
                  <option selected value=""> Choose Address</option>
                  <% for(var i = 1; i < accounts.length; i++){ %>
                    <option>
                            <%= accounts[i] %>
                    </option>
                    <% } %>
                </select>
            </div>

            <div class="mb-3 row">
                <div class="col-6">
                    <label for="latInput" class="form-label">Latitude</label>
                    <input type="text" class="form-control" id="latInput">    
                </div>

                <div class="col-6">
                    <label for="lonInput" class="form-label">Longitude</label>
                    <input type="text" class="form-control" id="lonInput">
                </div>
            </div>

            <div class="text-center">
                <button type="submit" class="btn btn-primary text-center" onclick="formSubmit()">Submit</button>
            </div>
        </form>
    </div>
</body>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script>
 
 
    function formSubmit() {
        const fromAddress = document.getElementById("selectedAddress").value
        const lat = document.getElementById("latInput").value
        const lon = document.getElementById("lonInput").value

        if (fromAddress == "" || lat == "" || lon == "") {
            alert("Error: Missing Arguments.")
            return
        }

        $.ajax({
            url:"/submit",
            type: "POST",
            async: false,
            data : {
                fromAddress: document.getElementById("selectedAddress").value,
                lat: document.getElementById("latInput").value,
                lon: document.getElementById("lonInput").value
            },
            cache : false,
            success : function (res) {
                if(res["success"]){
                    alert(res["result"]);
                }
                else if (!res["success"]) {
                    alert(res["result"])
                }
            },
            error : function () {
                // some error handling part
                alert("Request Failed");
            }
        });
    };
</script>
</html>